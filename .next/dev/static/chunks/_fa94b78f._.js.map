{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/arthur/mon-saas-ugc/lib/supabase.ts"],"sourcesContent":["// lib/supabase.ts\n\nimport { createClient } from '@supabase/supabase-js'\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n\n// ⚠️ UN SEUL CLIENT pour toute l'app\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    persistSession: true,\n    autoRefreshToken: true,\n  }\n})"],"names":[],"mappings":";;;;AAIoB;AAJpB,kBAAkB;AAElB;;AAEA,MAAM;AACN,MAAM;AAGC,MAAM,WAAW,IAAA,iMAAY,EAAC,aAAa,iBAAiB;IACjE,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;IACpB;AACF"}},
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///Users/arthur/mon-saas-ugc/app/signup/page.tsx"],"sourcesContent":["// app/signup/page.tsx\n\n'use client'\n\nimport { useState } from 'react'\nimport { supabase } from '@/lib/supabase' // ← Importe le client unique\nimport { useRouter } from 'next/navigation'\n\nexport default function SignupPage() {\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState('')\n  const router = useRouter()\n\n  async function handleSignup(e: React.FormEvent) {\n    e.preventDefault()\n    setLoading(true)\n    setError('')\n\n    try {\n      // 1. Créer le compte auth\n      const { data: authData, error: authError } = await supabase.auth.signUp({\n        email,\n        password,\n      })\n\n      if (authError) throw authError\n      if (!authData.user) throw new Error('Erreur création compte')\n\n      // 2. Créer l'entrée users (au cas où le trigger ne marche pas)\n      const { error: dbError } = await supabase\n        .from('users')\n        .insert({\n          id: authData.user.id,\n          email: authData.user.email,\n          credits: 50,\n          subscription_plan: 'free',\n          subscription_status: 'inactive'\n        })\n\n      // Ignore l'erreur si le user existe déjà (trigger a marché)\n      if (dbError && !dbError.message.includes('duplicate')) {\n        console.error('Erreur DB:', dbError)\n      }\n\n      alert('✅ Compte créé ! Redirection...')\n      router.push('/login')\n\n    } catch (err: any) {\n      console.error('Erreur:', err)\n      setError(err.message || 'Une erreur est survenue')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 p-4\">\n      <div className=\"max-w-md w-full bg-white p-8 rounded-lg shadow-md\">\n        <h1 className=\"text-2xl font-bold text-center mb-6\">\n          Créer un compte\n        </h1>\n\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 text-red-600 p-3 rounded mb-4 text-sm\">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSignup} className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium mb-2\">Email</label>\n            <input\n              type=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n              className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium mb-2\">\n              Mot de passe (min 6 caractères)\n            </label>\n            <input\n              type=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              minLength={6}\n              className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n            />\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium\"\n          >\n            {loading ? 'Création...' : 'Créer mon compte'}\n          </button>\n        </form>\n\n        <p className=\"text-center text-sm text-gray-600 mt-6\">\n          Déjà un compte ?{' '}\n          <a href=\"/login\" className=\"text-blue-600 hover:underline\">\n            Se connecter\n          </a>\n        </p>\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":";;;;;AAIA;AACA,yMAA0C,6BAA6B;AACvE;;;AANA,sBAAsB;AAEtB;;;;AAMe,SAAS;;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,SAAS,IAAA,kJAAS;IAExB,eAAe,aAAa,CAAkB;QAC5C,EAAE,cAAc;QAChB,WAAW;QACX,SAAS;QAET,IAAI;YACF,0BAA0B;YAC1B,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,8HAAQ,CAAC,IAAI,CAAC,MAAM,CAAC;gBACtE;gBACA;YACF;YAEA,IAAI,WAAW,MAAM;YACrB,IAAI,CAAC,SAAS,IAAI,EAAE,MAAM,IAAI,MAAM;YAEpC,+DAA+D;YAC/D,MAAM,EAAE,OAAO,OAAO,EAAE,GAAG,MAAM,8HAAQ,CACtC,IAAI,CAAC,SACL,MAAM,CAAC;gBACN,IAAI,SAAS,IAAI,CAAC,EAAE;gBACpB,OAAO,SAAS,IAAI,CAAC,KAAK;gBAC1B,SAAS;gBACT,mBAAmB;gBACnB,qBAAqB;YACvB;YAEF,4DAA4D;YAC5D,IAAI,WAAW,CAAC,QAAQ,OAAO,CAAC,QAAQ,CAAC,cAAc;gBACrD,QAAQ,KAAK,CAAC,cAAc;YAC9B;YAEA,MAAM;YACN,OAAO,IAAI,CAAC;QAEd,EAAE,OAAO,KAAU;YACjB,QAAQ,KAAK,CAAC,WAAW;YACzB,SAAS,IAAI,OAAO,IAAI;QAC1B,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAAsC;;;;;;gBAInD,uBACC,6LAAC;oBAAI,WAAU;8BACZ;;;;;;8BAIL,6LAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACtC,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;8CAAiC;;;;;;8CAClD,6LAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;oCACxC,QAAQ;oCACR,WAAU;;;;;;;;;;;;sCAId,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;8CAAiC;;;;;;8CAGlD,6LAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;oCAC3C,QAAQ;oCACR,WAAW;oCACX,WAAU;;;;;;;;;;;;sCAId,6LAAC;4BACC,MAAK;4BACL,UAAU;4BACV,WAAU;sCAET,UAAU,gBAAgB;;;;;;;;;;;;8BAI/B,6LAAC;oBAAE,WAAU;;wBAAyC;wBACnC;sCACjB,6LAAC;4BAAE,MAAK;4BAAS,WAAU;sCAAgC;;;;;;;;;;;;;;;;;;;;;;;AAOrE;GA1GwB;;QAKP,kJAAS;;;KALF"}}]
}